# DiffSoundReconstruction

## Repository structure

- `data/`: contains the data used in the experiments.
- `README.md`: this file.
- `environment.yml`: contains the conda environment used in the project.
- `audiodiffusion/`
- `features_decoding/` scripts from repo:KamitaniLab/SoundReconstruction.
- `scripts/` scripts from repo:teticio/audio-diffusion.

### Detailed Structure

You can find the detailed structure of the repository in the file `tree.txt` which is generated by the command `tree >> tree.txt`.

## Train the model

```zsh
export PYTHONPATH=$PYTHONPATH:$(pwd) 
accelerate launch \
    --config_file config/accelerate_local.yaml \
    scripts/train_unet.py \
    --dataset_name data/vgg_slided_train_mel \
    --output_dir models/ddpm-ema-audio-256 \
    --train_batch_size 16 \
    --num_epochs 100 \
    --gradient_accumulation_steps 1 \
    --learning_rate 1e-4 \
    --lr_warmup_steps 500 \
    --mixed_precision no \
    --vae models/autoencoder-kl_0 \
    --feat_dir data/features/conv5_3_train \
    --test_dir data/features/conv5_3_test
```
